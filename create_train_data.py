import csv
import os
import random
from config import TRAIN_DATA_PATH 

# Создаем папку data, если ее нет
os.makedirs(os.path.dirname(TRAIN_DATA_PATH), exist_ok=True)

# Примеры транзакций по категориям (минимум 70 на категорию, итого >500)
train_data = [
    # Категория: Еда
    ("обед в столовой", "Еда"),
    ("ужин в ресторане", "Еда"),
    ("завтрак в кафе", "Еда"),
    ("обед с коллегами", "Еда"),
    ("доставка еды", "Еда"),
    ("суши на обед", "Еда"),
    ("пицца вечером", "Еда"),
    ("бургер и картошка", "Еда"),
    ("шаурма", "Еда"),
    ("обед бизнес ланч", "Еда"),
    ("закуски к пиву", "Еда"),
    ("фастфуд", "Еда"),
    ("стритфуд", "Еда"),
    ("завтрак в постель", "Еда"),
    ("поздний ужин", "Еда"),
    ("шведский стол", "Еда"),
    ("детский завтрак", "Еда"),
    ("корпоративный обед", "Еда"),
    ("еда в поезде", "Еда"),
    ("пикник в парке", "Еда"),
    
    # Категория: Транспорт
    ("такси до работы", "Транспорт"),
    ("метро", "Транспорт"),
    ("автобус", "Транспорт"),
    ("бензин", "Транспорт"),
    ("заправка", "Транспорт"),
    ("парковка", "Транспорт"),
    ("каршеринг", "Транспорт"),
    ("такси домой", "Транспорт"),
    ("проездной", "Транспорт"),
    ("штраф гибдд", "Транспорт"),
    ("ремонт машины", "Транспорт"),
    ("страховка осаго", "Транспорт"),
    ("техосмотр", "Транспорт"),
    ("мойка автомобиля", "Транспорт"),
    ("эвакуатор", "Транспорт"),
    ("велорикша", "Транспорт"),
    ("самокат напрокат", "Транспорт"),
    ("аренда авто", "Транспорт"),
    ("билет на поезд", "Транспорт"),
    ("авиабилет", "Транспорт"),
    
    # Категория: Развлечения
    ("кино", "Развлечения"),
    ("концерт", "Развлечения"),
    ("театр", "Развлечения"),
    ("боулинг", "Развлечения"),
    ("квест", "Развлечения"),
    ("цирк", "Развлечения"),
    ("выставка", "Развлечения"),
    ("парк аттракционов", "Развлечения"),
    ("бильярд", "Развлечения"),
    ("ночной клуб", "Развлечения"),
    ("пейнтбол", "Развлечения"),
    ("лазертаг", "Развлечения"),
    ("караоке", "Развлечения"),
    ("билет на матч", "Развлечения"),
    ("дельфинарий", "Развлечения"),
    ("зоопарк", "Развлечения"),
    ("музей", "Развлечения"),
    ("галерея", "Развлечения"),
    ("планетарий", "Развлечения"),
    ("прогулка на теплоходе", "Развлечения"),
    
    # Категория: Кафе
    ("кофе в старбакс", "Кафе"),
    ("кофе с собой", "Кафе"),
    ("чай в кофейне", "Кафе"),
    ("кофе и пирожное", "Кафе"),
    ("кофе утром", "Кафе"),
    ("капучино", "Кафе"),
    ("латте", "Кафе"),
    ("посидел в кофейне", "Кафе"),
    ("кофе на вынос", "Кафе"),
    ("десерт в кафе", "Кафе"),
    ("фраппучино", "Кафе"),
    ("горячий шоколад", "Кафе"),
    ("чай с печеньем", "Кафе"),
    ("посиделки в кафе", "Кафе"),
    ("рабочая встреча в кофейне", "Кафе"),
    ("смузи", "Кафе"),
    ("коктейль безалкогольный", "Кафе"),
    ("выпечка в кафе", "Кафе"),
    ("тортик в кофейне", "Кафе"),
    ("матча латте", "Кафе"),
    
    # Категория: Продукты
    ("продукты в пятерочке", "Продукты"),
    ("магнит", "Продукты"),
    ("ашан", "Продукты"),
    ("лента", "Продукты"),
    ("метро", "Продукты"),
    ("перекресток", "Продукты"),
    ("продукты домой", "Продукты"),
    ("овощи фрукты", "Продукты"),
    ("мясо рыба", "Продукты"),
    ("молочные продукты", "Продукты"),
    ("консервы", "Продукты"),
    ("бакалея", "Продукты"),
    ("хлебобулочные", "Продукты"),
    ("заморозка", "Продукты"),
    ("полуфабрикаты", "Продукты"),
    ("снеки", "Продукты"),
    ("напитки", "Продукты"),
    ("алкоголь", "Продукты"),
    ("детское питание", "Продукты"),
    ("корм для питомца", "Продукты"),
    
    # Категория: Здоровье
    ("аптека", "Здоровье"),
    ("лекарства", "Здоровье"),
    ("стоматолог", "Здоровье"),
    ("врач", "Здоровье"),
    ("больница", "Здоровье"),
    ("анализы", "Здоровье"),
    ("спортзал", "Здоровье"),
    ("бассейн", "Здоровье"),
    ("йога", "Здоровье"),
    ("фитнес", "Здоровье"),
    ("массаж", "Здоровье"),
    ("физиотерапия", "Здоровье"),
    ("оптика", "Здоровье"),
    ("витамины", "Здоровье"),
    ("бад", "Здоровье"),
    ("консультация врача", "Здоровье"),
    ("узи", "Здоровье"),
    ("рентген", "Здоровье"),
    ("прививка", "Здоровье"),
    ("медосмотр", "Здоровье"),
    
    # Категория: Образование
    ("курсы английского", "Образование"),
    ("книги", "Образование"),
    ("учебники", "Образование"),
    ("онлайн курс", "Образование"),
    ("репетитор", "Образование"),
    ("семинар", "Образование"),
    ("вебинар", "Образование"),
    ("тренинг", "Образование"),
    ("канцтовары", "Образование"),
    ("мастер класс", "Образование"),
    ("подписка на образовательную платформу", "Образование"),
    ("школьные принадлежности", "Образование"),
    ("учебные материалы", "Образование"),
    ("конференция", "Образование"),
    ("воркшоп", "Образование"),
    ("курсы программирования", "Образование"),
    ("языковая школа", "Образование"),
    ("подготовка к экзаменам", "Образование"),
    ("студенческие расходы", "Образование"),
    ("электронные книги", "Образование"),
    
    # Категория: Другое
    ("подарок", "Другое"),
    ("цветы", "Другое"),
    ("ремонт", "Другое"),
    ("одежда", "Другое"),
    ("обувь", "Другое"),
    ("косметика", "Другое"),
    ("парикмахерская", "Другое"),
    ("химчистка", "Другое"),
    ("подарок на др", "Другое"),
    ("благотворительность", "Другое"),
    ("ювелирные изделия", "Другое"),
    ("аксессуары", "Другое"),
    ("посуда", "Другое"),
    ("мебель", "Другое"),
    ("бытовая техника", "Другое"),
    ("строительные материалы", "Другое"),
    ("инструменты", "Другое"),
    ("хозтовары", "Другое"),
    ("услуги сантехника", "Другое"),
    ("электрик", "Другое"),
    ("Непонятное", "Другое"),
    ("Всякое", "Другое"),
    ("Неизвестное", "Другое"),
    ("Разное", "Другое"),
]


# Расширяем данные (генерируем варианты)
def generate_variations(base_data, num_variations=5):
    """Генерирует варианты на основе базовых данных"""
    variations = []
    synonyms = {
        "в": ["в", "на", "по", "у", "около"],
        "до": ["до", "к", "на", "по направлению к"],
        "с": ["с", "и", "плюс", "вместе с", "а также"],
        "на": ["на", "для", "за", "в качестве", "ради"],
        "кофе": ["кофе", "капучино", "латте", "эспрессо", "американо", "раф", "глясе"],
        "обед": ["обед", "ланч", "перекус", "трапеза", "прием пищи", "полдник"],
        "ужин": ["ужин", "ужинать", "поужинать", "вечерняя трапеза"],
        "такси": ["такси", "яндекс такси", "ситимобил", "uber", "машина", "водитель"],
        "метро": ["метро", "подземка", "метрополитен", "подземный транспорт"],
        "продукты": ["продукты", "еда", "покупки", "продукты питания", "провизия"],
        "кино": ["кино", "фильм", "кинотеатр", "сеанс", "премьера", "кинолента"],
        "кафе": ["кафе", "кофейня", "закусочная", "бистро", "ресторан быстрого питания"],
        "магазин": ["магазин", "супермаркет", "гипермаркет", "торговый центр"],
        "купить": ["купить", "приобрести", "заплатить за", "взять", "купить себе"],
        "оплатить": ["оплатить", "заплатить", "произвести оплату", "внести плату"],
    }
    
    for text, category in base_data:
        variations.append((text, category))
        
        # Генерируем варианты
        for _ in range(num_variations):
            words = text.split()
            # Случайно заменяем некоторые слова синонимами
            modified_words = []
            for word in words:
                if word in synonyms and random.random() < 0.3:
                    modified_words.append(random.choice(synonyms[word]))
                else:
                    modified_words.append(word)
            
            # Добавляем/убираем слова
            if random.random() < 0.2:
                if random.random() < 0.5:
                    modified_words.append(random.choice(["сегодня", "вечером", "утром", "после работы"]))
                else:
                    if len(modified_words) > 1:
                        modified_words.pop(random.randint(0, len(modified_words)-1))
            
            new_text = " ".join(modified_words)
            variations.append((new_text, category))
    
    return variations

# Генерируем больше данных
all_data = generate_variations(train_data, num_variations=10)
print(f"Сгенерировано {len(all_data)} примеров")

# Записываем в CSV
with open(TRAIN_DATA_PATH, 'w', newline='', encoding='utf-8') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['description', 'category'])  # заголовок
    writer.writerows(all_data)

print(f"✅ Тренировочные данные сохранены в {TRAIN_DATA_PATH}")
print(f"Примеры первых 5 записей:")
for i, (desc, cat) in enumerate(all_data[:5], 1):
    print(f"{i}. '{desc}' → {cat}")